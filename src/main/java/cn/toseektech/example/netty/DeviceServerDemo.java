package cn.toseektech.example.netty;

import java.io.FileNotFoundException;
import java.nio.charset.StandardCharsets;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import io.netty.bootstrap.ServerBootstrap;
import io.netty.buffer.ByteBuf;
import io.netty.buffer.ByteBufAllocator;
import io.netty.buffer.CompositeByteBuf;
import io.netty.channel.ChannelHandlerContext;
import io.netty.channel.ChannelInitializer;
import io.netty.channel.ChannelOption;
import io.netty.channel.EventLoopGroup;
import io.netty.channel.SimpleChannelInboundHandler;
import io.netty.channel.nio.NioEventLoopGroup;
import io.netty.channel.socket.SocketChannel;
import io.netty.channel.socket.nio.NioServerSocketChannel;
import io.netty.handler.codec.LineBasedFrameDecoder;
import io.netty.handler.codec.MessageToByteEncoder;
import io.netty.handler.codec.string.StringDecoder;
import io.netty.util.concurrent.DefaultThreadFactory;
import io.netty.util.concurrent.UnorderedThreadPoolEventExecutor;

public class DeviceServerDemo {

	private static Logger logger = LoggerFactory.getLogger(DeviceServerDemo.class);

	public static void main(String[] args) throws InterruptedException, FileNotFoundException {

		// 处理accept事件的线程池
		EventLoopGroup bossGroup = new NioEventLoopGroup(1, new DefaultThreadFactory("boss"));
		// 处理非业务handler的线程池
		EventLoopGroup workerGroup = new NioEventLoopGroup(new DefaultThreadFactory("worker"));
		// 处理业务handler用的线程池
		UnorderedThreadPoolEventExecutor bussinessExcutor = new UnorderedThreadPoolEventExecutor(25,
				new DefaultThreadFactory("bussiness"));
		// nettyServer启动
		ServerBootstrap serverBootStrap = new ServerBootstrap();
		serverBootStrap.group(bossGroup, workerGroup).channel(NioServerSocketChannel.class)
				.option(ChannelOption.SO_BACKLOG, 100).childOption(ChannelOption.SO_KEEPALIVE, true)
				.childOption(ChannelOption.TCP_NODELAY, true).childHandler(new ChannelInitializer<SocketChannel>() {
					@Override
					protected void initChannel(SocketChannel ch) throws Exception {
						ch.pipeline()
						        .addLast(new DelimiterEncoder())
						        .addLast(new LineBasedFrameDecoder(20480))
								.addLast(new StringDecoder())								
								.addLast(bussinessExcutor, new CommandHandler())
								//.addLast(new StringEncoder())
						        ;
					}
				}).bind(2000).sync();
		logger.info("NettyServer配置启动完成");
		//监控启动
		GobalMonitor.start();
	}

}

class CommandHandler extends SimpleChannelInboundHandler<String> {
	

	@Override
	protected void channelRead0(ChannelHandlerContext ctx, String msg) throws Exception {
		  String responseMsg = "";
		 if(msg.equals("FS+REQ_WVL_DATA")){
			 responseMsg = "+REQ_WVL_DATA=314.6;315.0;315.5;316.0;316.4;316.9;317.4;317.9;318.3;318.8;319.3;319.7;320.2;320.7;321.1;321.6;322.1;322.5;323.0;323.5;323.9;324.4;324.9;325.3;325.8;326.3;326.8;327.2;327.7;328.2;328.6;329.1;329.6;330.0;330.5;331.0;331.4;331.9;332.4;332.8;333.3;333.8;334.2;334.7;335.2;335.6;336.1;336.6;337.0;337.5;338.0;338.4;338.9;339.4;339.8;340.3;340.7;341.2;341.7;342.1;342.6;343.1;343.5;344.0;344.5;344.9;345.4;345.9;346.3;346.8;347.3;347.7;348.2;348.7;349.1;349.6;350.0;350.5;351.0;351.4;351.9;352.4;352.8;353.3;353.8;354.2;354.7;355.1;355.6;356.1;356.5;357.0;357.5;357.9;358.4;358.8;359.3;359.8;360.2;360.7;361.2;361.6;362.1;362.5;363.0;363.5;363.9;364.4;364.9;365.3;365.8;366.2;366.7;367.2;367.6;368.1;368.6;369.0;369.5;369.9;370.4;370.9;371.3;371.8;372.2;372.7;373.2;373.6;374.1;374.5;375.0;375.5;375.9;376.4;376.8;377.3;377.8;378.2;378.7;379.1;379.6;380.1;380.5;381.0;381.4;381.9;382.4;382.8;383.3;383.7;384.2;384.6;385.1;385.6;386.0;386.5;386.9;387.4;387.9;388.3;388.8;389.2;389.7;390.1;390.6;391.1;391.5;392.0;392.4;392.9;393.3;393.8;394.3;394.7;395.2;395.6;396.1;396.5;397.0;397.5;397.9;398.4;398.8;399.3;399.7;400.2;400.7;401.1;401.6;402.0;402.5;402.9;403.4;403.8;404.3;404.8;405.2;405.7;406.1;406.6;407.0;407.5;407.9;408.4;408.9;409.3;409.8;410.2;410.7;411.1;411.6;412.0;412.5;412.9;413.4;413.9;414.3;414.8;415.2;415.7;416.1;416.6;417.0;417.5;417.9;418.4;418.8;419.3;419.8;420.2;420.7;421.1;421.6;422.0;422.5;422.9;423.4;423.8;424.3;424.7;425.2;425.6;426.1;426.5;427.0;427.4;427.9;428.3;428.8;429.2;429.7;430.2;430.6;431.1;431.5;432.0;432.4;432.9;433.3;433.8;434.2;434.7;435.1;435.6;436.0;436.5;436.9;437.4;437.8;438.3;438.7;439.2;439.6;440.1;440.5;441.0;441.4;441.9;442.3;442.8;443.2;443.7;444.1;444.6;445.0;445.5;445.9;446.4;446.8;447.3;447.7;448.2;448.6;449.0;449.5;449.9;450.4;450.8;451.3;451.7;452.2;452.6;453.1;453.5;454.0;454.4;454.9;455.3;455.8;456.2;456.7;457.1;457.6;458.0;458.4;458.9;459.3;459.8;460.2;460.7;461.1;461.6;462.0;462.5;462.9;463.4;463.8;464.3;464.7;465.1;465.6;466.0;466.5;466.9;467.4;467.8;468.3;468.7;469.2;469.6;470.0;470.5;470.9;471.4;471.8;472.3;472.7;473.2;473.6;474.0;474.5;474.9;475.4;475.8;476.3;476.7;477.2;477.6;478.0;478.5;478.9;479.4;479.8;480.3;480.7;481.1;481.6;482.0;482.5;482.9;483.4;483.8;484.2;484.7;485.1;485.6;486.0;486.5;486.9;487.3;487.8;488.2;488.7;489.1;489.6;490.0;490.4;490.9;491.3;491.8;492.2;492.6;493.1;493.5;494.0;494.4;494.9;495.3;495.7;496.2;496.6;497.1;497.5;497.9;498.4;498.8;499.3;499.7;500.1;500.6;501.0;501.5;501.9;502.3;502.8;503.2;503.7;504.1;504.5;505.0;505.4;505.9;506.3;506.7;507.2;507.6;508.0;508.5;508.9;509.4;509.8;510.2;510.7;511.1;511.6;512.0;512.4;512.9;513.3;513.7;514.2;514.6;515.1;515.5;515.9;516.4;516.8;517.2;517.7;518.1;518.6;519.0;519.4;519.9;520.3;520.7;521.2;521.6;522.1;522.5;522.9;523.4;523.8;524.2;524.7;525.1;525.5;526.0;526.4;526.8;527.3;527.7;528.2;528.6;529.0;529.5;529.9;530.3;530.8;531.2;531.6;532.1;532.5;532.9;533.4;533.8;534.2;534.7;535.1;535.5;536.0;536.4;536.9;537.3;537.7;538.2;538.6;539.0;539.5;539.9;540.3;540.8;541.2;541.6;542.1;542.5;542.9;543.4;543.8;544.2;544.7;545.1;545.5;545.9;546.4;546.8;547.2;547.7;548.1;548.5;549.0;549.4;549.8;550.3;550.7;551.1;551.6;552.0;552.4;552.9;553.3;553.7;554.2;554.6;555.0;555.4;555.9;556.3;556.7;557.2;557.6;558.0;558.5;558.9;559.3;559.8;560.2;560.6;561.0;561.5;561.9;562.3;562.8;563.2;563.6;564.1;564.5;564.9;565.3;565.8;566.2;566.6;567.1;567.5;567.9;568.3;568.8;569.2;569.6;570.1;570.5;570.9;571.3;571.8;572.2;572.6;573.1;573.5;573.9;574.3;574.8;575.2;575.6;576.0;576.5;576.9;577.3;577.8;578.2;578.6;579.0;579.5;579.9;580.3;580.7;581.2;581.6;582.0;582.5;582.9;583.3;583.7;584.2;584.6;585.0;585.4;585.9;586.3;586.7;587.1;587.6;588.0;588.4;588.8;589.3;589.7;590.1;590.5;591.0;591.4;591.8;592.2;592.7;593.1;593.5;593.9;594.4;594.8;595.2;595.6;596.1;596.5;596.9;597.3;597.8;598.2;598.6;599.0;599.4;599.9;600.3;600.7;601.1;601.6;602.0;602.4;602.8;603.3;603.7;604.1;604.5;604.9;605.4;605.8;606.2;606.6;607.1;607.5;607.9;608.3;608.7;609.2;609.6;610.0;610.4;610.9;611.3;611.7;612.1;612.5;613.0;613.4;613.8;614.2;614.6;615.1;615.5;615.9;616.3;616.8;617.2;617.6;618.0;618.4;618.9;619.3;619.7;620.1;620.5;621.0;621.4;621.8;622.2;622.6;623.1;623.5;623.9;624.3;624.7;625.1;625.6;626.0;626.4;626.8;627.2;627.7;628.1;628.5;628.9;629.3;629.8;630.2;630.6;631.0;631.4;631.8;632.3;632.7;633.1;633.5;633.9;634.3;634.8;635.2;635.6;636.0;636.4;636.9;637.3;637.7;638.1;638.5;638.9;639.4;639.8;640.2;640.6;641.0;641.4;641.9;642.3;642.7;643.1;643.5;643.9;644.3;644.8;645.2;645.6;646.0;646.4;646.8;647.3;647.7;648.1;648.5;648.9;649.3;649.7;650.2;650.6;651.0;651.4;651.8;652.2;652.6;653.1;653.5;653.9;654.3;654.7;655.1;655.5;656.0;656.4;656.8;657.2;657.6;658.0;658.4;658.9;659.3;659.7;660.1;660.5;660.9;661.3;661.7;662.2;662.6;663.0;663.4;663.8;664.2;664.6;665.0;665.5;665.9;666.3;666.7;667.1;667.5;667.9;668.3;668.8;669.2;669.6;670.0;670.4;670.8;671.2;671.6;672.0;672.5;672.9;673.3;673.7;674.1;674.5;674.9;675.3;675.7;676.1;676.6;677.0;677.4;677.8;678.2;678.6;679.0;679.4;679.8;680.2;680.7;681.1;681.5;681.9;682.3;682.7;683.1;683.5;683.9;684.3;684.7;685.2;685.6;686.0;686.4;686.8;687.2;687.6;688.0;688.4;688.8;689.2;689.6;690.1;690.5;690.9;691.3;691.7;692.1;692.5;692.9;693.3;693.7;694.1;694.5;694.9;695.3;695.8;696.2;696.6;697.0;697.4;697.8;698.2;698.6;699.0;699.4;699.8;700.2;700.6;701.0;701.4;701.8;702.3;702.7;703.1;703.5;703.9;704.3;704.7;705.1;705.5;705.9;706.3;706.7;707.1;707.5;707.9;708.3;708.7;709.1;709.5;709.9;710.4;710.8;711.2;711.6;712.0;712.4;712.8;713.2;713.6;714.0;714.4;714.8;715.2;715.6;716.0;716.4;716.8;717.2;717.6;718.0;718.4;718.8;719.2;719.6;720.0;720.4;720.8;721.2;721.6;722.0;722.4;722.8;723.2;723.6;724.0;724.5;724.9;725.3;725.7;726.1;726.5;726.9;727.3;727.7;728.1;728.5;728.9;729.3;729.7;730.1;730.5;730.9;731.3;731.7;732.1;732.5;732.9;733.3;733.7;734.1;734.5;734.9;735.3;735.7;736.1;736.5;736.9;737.3;737.7;738.1;738.5;738.9;739.3;739.7;740.1;740.5;740.9;741.3;741.7;742.1;742.5;742.8;743.2;743.6;744.0;744.4;744.8;745.2;745.6;746.0;746.4;746.8;747.2;747.6;748.0;748.4;748.8;749.2;749.6;750.0;750.4;750.8;751.2;751.6;752.0;752.4;752.8;753.2;753.6;754.0;754.4;754.8;755.2;755.6;756.0;756.3;756.7;757.1;757.5;757.9;758.3;758.7;759.1;759.5;759.9;760.3;760.7;761.1;761.5;761.9;762.3;762.7;763.1;763.5;763.9;764.3;764.6;765.0;765.4;765.8;766.2;766.6;767.0;767.4;767.8;768.2;768.6;769.0;769.4;769.8;770.2;770.6;770.9;771.3;771.7;772.1;772.5;772.9;773.3;773.7;774.1;774.5;774.9;775.3;775.7;776.0;776.4;776.8;777.2;777.6;778.0;778.4;778.8;779.2;779.6;780.0;780.4;780.8;781.1;781.5;781.9;782.3;782.7;783.1;783.5;783.9;784.3;784.7;785.1;785.4;785.8;786.2;786.6;787.0;787.4;787.8;788.2;788.6;789.0;789.3;789.7;790.1;790.5;790.9;791.3;791.7;792.1;792.5;792.8;793.2;793.6;794.0;794.4;794.8;795.2;795.6;796.0;796.3;796.7;797.1;797.5;797.9;798.3;798.7;799.1;799.5;799.8;800.2;800.6;801.0;801.4;801.8;802.2;802.6;802.9;803.3;803.7;804.1;804.5;804.9;805.3;805.6;806.0;806.4;806.8;807.2;807.6;808.0;808.4;808.7;809.1;809.5;809.9;810.3;810.7;811.1;811.4;811.8;812.2;812.6;813.0;813.4;813.8;814.1;814.5;814.9;815.3;815.7;816.1;816.4;816.8;817.2;817.6;818.0;818.4;818.8;819.1;819.5;819.9;820.3;820.7;821.1;821.4;821.8;822.2;822.6;823.0;823.4;823.7;824.1;824.5;824.9;825.3;825.7;826.0;826.4;826.8;827.2;827.6;828.0;828.3;828.7;829.1;829.5;829.9;830.3;830.6;831.0;831.4;831.8;832.2;832.5;832.9;833.3;833.7;834.1;834.5;834.8;835.2;835.6;836.0;836.4;836.7;837.1;837.5;837.9;838.3;838.6;839.0;839.4;839.8;840.2;840.5;840.9;841.3;841.7;842.1;842.4;842.8;843.2;843.6;844.0;844.3;844.7;845.1;845.5;845.9;846.2;846.6;847.0;847.4;847.8;848.1;848.5;848.9;849.3;849.6;850.0;850.4;850.8;851.2;851.5;851.9;852.3;852.7;853.0;853.4;853.8;854.2;854.6;854.9;855.3;855.7;856.1;856.4;856.8;857.2;857.6;858.0;858.3;858.7;859.1;859.5;859.8;860.2;860.6;861.0;861.3;861.7;862.1;862.5;862.8;863.2;863.6;864.0;864.4;864.7;865.1;865.5;865.9;866.2;866.6;867.0;867.4;867.7;868.1;868.5;868.9;869.2;869.6;870.0;870.4;870.7;871.1;871.5;871.8;872.2;872.6;873.0;873.3;873.7;874.1;874.5;874.8;875.2;875.6;876.0;876.3;876.7;877.1;877.5;877.8;878.2;878.6;878.9;879.3;879.7;880.1;880.4;880.8;881.2;881.6;881.9;882.3;882.7;883.0;883.4;883.8;884.2;884.5;884.9;885.3;885.6;886.0;886.4;886.8;887.1;887.5;887.9;888.2;888.6;889.0;889.4;889.7;890.1;890.5;890.8;891.2;891.6;891.9;892.3;892.7;893.1;893.4;893.8;894.2;894.5;894.9;895.3;895.6;896.0;896.4;896.8;897.1;897.5;897.9;898.2;898.6;899.0;899.3;899.7;900.1;900.4;900.8;901.2;901.6;901.9;902.3;902.7;903.0;903.4;903.8;904.1;904.5;904.9;905.2;905.6;906.0;906.3;906.7;907.1;907.4;907.8;908.2;908.5;908.9;909.3;909.6;910.0;910.4;910.7;911.1;911.5;911.8;912.2;912.6;912.9;913.3;913.7;914.0;914.4;914.8;915.1;915.5;915.9;916.2;916.6;917.0;917.3;917.7;918.1;918.4;918.8;919.1;919.5;919.9;920.2;920.6;921.0;921.3;921.7;922.1;922.4;922.8;923.2;923.5;923.9;924.3;924.6;925.0;925.3;925.7;926.1;926.4;926.8;927.2;927.5;927.9;928.3;928.6;929.0;929.3;929.7;930.1;930.4;930.8;931.2;931.5;931.9;932.2;932.6;933.0;933.3;933.7;934.1;934.4;934.8;935.1;935.5;935.9;936.2;936.6;936.9;937.3;937.7;938.0;938.4;938.8;939.1;939.5;939.8;940.2;940.6;940.9;941.3;941.6;942.0;942.4;942.7;943.1;943.4;943.8;944.2;944.5;944.9;945.2;945.6;946.0;946.3;946.7;947.0;947.4;947.8;948.1;948.5;948.8;949.2;949.5;949.9;950.3;950.6;951.0;951.3;951.7;952.1;952.4;952.8;953.1;953.5;953.8;954.2;954.6;954.9;955.3;955.6;956.0;956.4;956.7;957.1;957.4;957.8;958.1;958.5;958.9;959.2;959.6;959.9;960.3;960.6;961.0;961.4;961.7;962.1;962.4;962.8;963.1;963.5;963.8;964.2;964.6;964.9;965.3;965.6;966.0;966.3;966.7;967.0;967.4;967.8;968.1;968.5;968.8;969.2;969.5;969.9;970.2;970.6;971.0;971.3;971.7;972.0;972.4;972.7;973.1;973.4;973.8;974.1;974.5;974.8;975.2;975.6;975.9;976.3;976.6;977.0;977.3;977.7;978.0;978.4;978.7;979.1;979.4;979.8;980.1;980.5;980.8;981.2;981.6;981.9;982.3;982.6;983.0;983.3;983.7;984.0;984.4;984.7;985.1;985.4;985.8;986.1;986.5;986.8;987.2;987.5;987.9;988.2;988.6;988.9;989.3;989.6;990.0;990.3;990.7;991.0;991.4;991.7;992.1;992.4;992.8;993.1;993.5;993.8;994.2;994.5;994.9;995.2;995.6;995.9;996.3;996.6;997.0;997.3;997.7;998.0;998.4;998.7;999.1;999.4;999.8;1000.1;1000.5;1000.8;1001.2;1001.5;1001.9;1002.2;1002.6;1002.9;1003.3;1003.6;1004.0;1004.3;1004.7;1005.0;1005.3;1005.7;1006.0;1006.4;1006.7;1007.1;1007.4;1007.8;1008.1;1008.5;1008.8;1009.2;1009.5;1009.9;1010.2;1010.6;1010.9;1011.2;1011.6;1011.9;1012.3;1012.6;1013.0;1013.3;1013.7;1014.0;1014.4;1014.7;1015.0;1015.4;1015.7;1016.1;1016.4;1016.8;1017.1;1017.5;1017.8;1018.2;1018.5;1018.8;1019.2;1019.5;1019.9;1020.2;1020.6;1020.9;1021.3;1021.6;1021.9;1022.3;1022.6;1023.0;1023.3;1023.7;1024.0;1024.3;1024.7;1025.0;1025.4;1025.7;1026.1;1026.4;1026.7;1027.1;1027.4;1027.8;1028.1;1028.5;1028.8;1029.1;1029.5;1029.8;1030.2;1030.5;1030.9;1031.2;1031.5;1031.9;1032.2;1032.6;1032.9;1033.3;1033.6;1033.9;1034.3;1034.6;1035.0;1035.3;1035.6;1036.0;1036.3;1036.7;1037.0;1037.3;1037.7;1038.0;1038.4;1038.7;1039.1;1039.4;1039.7;1040.1;1040.4;1040.8;1041.1;1041.4;1041.8;1042.1;1042.5;1042.8;1043.1;1043.5;1043.8;1044.1;1044.5;1044.8;1045.2;1045.5;1045.8;1046.2;1046.5;1046.9;1047.2;1047.5;1047.9;1048.2;1048.6;1048.9;1049.2;1049.6;1049.9;1050.2;1050.6;1050.9;1051.3;1051.6;1051.9;1052.3;1052.6;1052.9;1053.3;1053.6;1054.0;1054.3;1054.6;1055.0;1055.3;1055.6;1056.0;1056.3;1056.7;1057.0;1057.3;1057.7;1058.0;1058.3;1058.7;1059.0;1059.3;1059.7;1060.0;1060.4;1060.7;1061.0;1061.4;1061.7;1062.0;1062.4;1062.7;1063.0;1063.4;1063.7;1064.0;1064.4;1064.7;1065.0;1065.4;1065.7;1066.0;1066.4;1066.7;1067.1;1067.4;1067.7;1068.1;1068.4;1068.7;1069.1;1069.4;1069.7;1070.1;1070.4;1070.7;1071.1;1071.4;1071.7;1072.1;1072.4;1072.7;1073.1;1073.4;1073.7;1074.1;1074.4;1074.7;1075.1;1075.4;1075.7;1076.1;1076.4;1076.7;1077.1;1077.4;1077.7;1078.0;1078.4;1078.7;1079.0;1079.4;1079.7;1080.0;1080.4;1080.7;1081.0;1081.4;1081.7;1082.0;1082.4;1082.7;1083.0;1083.4;1083.7;1084.0;1084.3;1084.7;1085.0;1085.3;1085.7;1086.0;1086.3;1086.7;1087.0;1087.3;1087.6;1088.0;1088.3;1088.6;1089.0;1089.3;1089.6;1090.0;1090.3;1090.6;1090.9;1091.3;1091.6;1091.9;1092.3;1092.6;1092.9;1093.2;1093.6;1093.9;1094.2;1094.6;1094.9;1095.2;1095.5;1095.9;1096.2;1096.5;1096.9;1097.2;1097.5;1097.8;1098.2;1098.5;1098.8;1099.1;1099.5;1099.8;1100.1;1100.5;1100.8;1101.1;1101.4;1101.8;1102.1;1102.4;1102.7;1103.1;1103.4;1103.7;1104.0;1104.4;1104.7;1105.0;1105.4;1105.7;1106.0;1106.3;1106.7;1107.0;1107.3;1107.6;1108.0;1108.3;1108.6;1108.9;1109.3;1109.6;1109.9;1110.2;1110.6;1110.9;1111.2;1111.5;1111.9;1112.2;1112.5;1112.8;1113.2;1113.5;1113.8;1114.1;1114.5;1114.8;1115.1;1115.4;1115.7;1116.1;1116.4;1116.7;1117.0;1117.4;1117.7;1118.0;1118.3;1118.7;1119.0;1119.3;1119.6;1120.0;1120.3;1120.6;1120.9;1121.2;1121.6;1121.9;1122.2;1122.5;1122.9;1123.2;1123.5;1123.8;1124.1;1124.5;";
			 ctx.writeAndFlush(responseMsg);			 
		 }
		 
		 if(msg.equals("FS+REQ_SPECT_DATA")) {
			 responseMsg = "+REQ_SPECT_DATA=Date:2021- 6- 7,Time:21: 1:12,11,500 us,36.0¡æ,16393;16550;15177;16376;16403;16390;16405;16412;16395;16414;16389;16426;16402;16450;16392;16437;16359;16455;16361;16458;16351;16442;16360;16429;16370;16474;16359;16468;16350;16446;16348;16481;16326;16450;16339;16481;16383;16470;16357;16470;16363;16475;16344;16450;16335;16459;16355;16442;16367;16443;16354;16416;16387;16426;16379;16397;16430;16406;16441;16382;16430;16379;16418;16358;16439;16370;16454;16322;16462;16343;16494;16336;16470;16315;16464;16332;16458;16323;16470;16334;16462;16350;16468;16396;16439;16391;16397;16414;16431;16403;16411;16412;16378;16414;16352;16420;16363;16443;16330;16432;16351;16459;16337;16457;16326;16470;16334;16471;16306;16446;16358;16450;16395;16455;16396;16412;16370;16374;16422;16368;16450;16351;16463;16339;16462;16331;16481;16336;16478;16331;16487;16341;16462;16343;16459;16333;16450;16378;16422;16383;16431;16406;16392;16426;16355;16419;16331;16474;16334;16475;16336;16477;16359;16479;16344;16450;16366;16446;16397;16422;16406;16394;16406;16369;16450;16371;16444;16337;16446;16342;16449;16319;16466;16315;16488;16340;16458;16362;16407;16394;16394;16407;16404;16449;16383;16466;16349;16470;16319;16478;16321;16460;16327;16467;16367;16440;16399;16415;16415;16367;16450;16363;16446;16346;16470;16338;16492;16338;16499;16355;16462;16382;16430;16386;16399;16406;16355;16451;16349;16458;16318;16499;16323;16437;16307;16446;16363;16428;16379;16390;16408;16359;16434;16330;16427;16336;16459;16335;16466;16335;16455;16343;16410;16378;16407;16386;16403;16430;16367;16439;16350;16451;16326;16454;16333;16443;16346;16450;16396;16414;16403;16370;16446;16359;16443;16351;16474;16341;16463;16311;16492;16355;16463;16363;16429;16401;16374;16407;16357;16473;16351;16482;16335;16462;16347;16482;16364;16428;16415;16406;16425;16367;16439;16346;16481;16307;16471;16306;16486;16337;16466;16375;16417;16393;16374;16443;16325;16448;16331;16446;16316;16453;16363;16446;16389;16386;16395;16347;16411;16327;16443;16318;16489;16341;16487;16363;16420;16378;16374;16402;16358;16419;16347;16446;16327;16468;16314;16443;16370;16434;16391;16371;16423;16319;16462;16343;16490;16314;16466;16334;16403;16372;16382;16415;16365;16434;16330;16486;16340;16464;16339;16434;16379;16366;16418;16366;16461;16318;16483;16287;16444;16341;16450;16354;16411;16390;16375;16434;16343;16450;16322;16450;16337;16421;16362;16367;16398;16372;16450;16314;16493;16318;16455;16343;16438;16384;16367;16426;16373;16452;16339;16443;16326;16450;16366;16442;16381;16388;16434;16375;16464;16320;16483;16318;16466;16347;16403;16387;16359;16465;16338;16487;16311;16492;16350;16435;16388;16370;16399;16339;16470;16322;16478;16314;16456;16366;16382;16395;16351;16448;16338;16490;16342;16459;16350;16419;16393;16357;16418;16327;16487;16330;16487;16355;16450;16388;16362;16451;16332;16478;16319;16478;16373;16448;16419;16378;16452;16333;16498;16346;16475;16326;16458;16411;16399;16445;16338;16459;16330;16463;16334;16439;16387;16398;16442;16350;16497;16332;16459;16342;16401;16400;16354;16435;16332;16493;16335;16467;16366;16437;16410;16342;16435;16318;16478;16322;16469;16374;16399;16402;16342;16458;16307;16450;16313;16452;16395;16398;16411;16342;16455;16311;16464;16290;16414;16374;16395;16440;16350;16483;16311;16488;16374;16407;16374;16341;16443;16334;16497;16337;16470;16347;16422;16385;16375;16442;16317;16460;16366;16470;16367;16402;16422;16359;16458;16322;16459;16303;16469;16394;16422;16426;16350;16471;16343;16486;16334;16453;16331;16394;16412;16346;16467;16342;16478;16329;16459;16363;16420;16398;16374;16462;16333;16482;16339;16455;16358;16400;16406;16359;16458;16336;16471;16307;16475;16375;16443;16423;16386;16429;16342;16462;16313;16502;16343;16459;16385;16415;16439;16351;16482;16308;16450;16327;16471;16367;16411;16419;16390;16446;16366;16471;16337;16471;16359;16438;16385;16394;16450;16383;16487;16340;16499;16323;16480;16354;16422;16394;16387;16439;16363;16467;16361;16472;16331;16483;16363;16425;16419;16370;16449;16359;16499;16335;16499;16359;16474;16391;16408;16428;16383;16462;16365;16479;16319;16482;16361;16454;16387;16394;16418;16385;16442;16354;16475;16324;16511;16355;16437;16353;16411;16406;16370;16423;16335;16474;16350;16482;16334;16443;16354;16419;16378;16374;16437;16355;16471;16339;16480;16334;16463;16367;16431;16391;16378;16399;16383;16464;16335;16459;16329;16456;16338;16479;16355;16427;16407;16398;16451;16340;16471;16310;16462;16339;16475;16366;16445;16374;16406;16414;16399;16438;16323;16471;16321;16463;16330;16467;16353;16447;16403;16415;16409;16374;16439;16327;16465;16331;16478;16331;16491;16361;16459;16390;16421;16416;16406;16410;16363;16453;16351;16455;16331;16486;16366;16482;16380;16429;16402;16415;16397;16391;16434;16366;16479;16337;16479;16339;16468;16337;16474;16367;16476;16390;16443;16430;16371;16433;16351;16475;16330;16464;16343;16470;16347;16465;16383;16438;16382;16406;16390;16375;16449;16334;16466;16339;16498;16332;16482;16338;16456;16340;16438;16383;16390;16400;16411;16422;16350;16470;16335;16478;16300;16491;16354;16490;16347;16483;16358;16423;16405;16372;16431;16350;16458;16332;16482;16346;16468;16341;16474;16346;16468;16351;16446;16375;16411;16423;16410;16434;16363;16449;16358;16450;16330;16482;16335;16490;16353;16479;16350;16458;16383;16406;16422;16402;16430;16361;16463;16386;16490;16316;16470;16335;16460;16340;16475;16350;16486;16372;16458;16379;16425;16421;16391;16410;16392;16424;16362;16463;16342;16464;16335;16478;16316;16449;16318;16471;16339;16468;16363;16443;16407;16425;16398;16374;16420;16356;16430;16363;16455;16371;16462;16343;16486;16362;16494;16334;16482;16330;16458;16326;16481;16358;16459;16363;16453;16413;16422;16419;16420;16430;16371;16446;16384;16436;16343;16482;16346;16432;16334;16466;16353;16479;16343;16483;16334;16491;16374;16478;16351;16441;16374;16434;16388;16410;16427;16399;16433;16397;16426;16362;16443;16366;16446;16338;16469;16382;16487;16343;16483;16341;16498;16351;16476;16328;16479;16363;16480;16402;16463;16387;16474;16369;16442;16371;16455;16364;16423;16394;16417;16413;16406;16418;16414;16457;16378;16427;16369;16439;16366;16438;16373;16441;16359;16467;16349;16454;16327;16471;16350;16480;16359;16462;16349;16493;16339;16467;16338;16454;16354;16470;16341;16459;16366;16471;16359;16462;16355;16474;16352;16433;16359;16450;16387;16433;16382;16430;16374;16422;16382;16414;16368;16452;16386;16423;16404;16439;16390;16406;16385;16413;16419;16402;16402;16402;16407;16399;16424;16380;16399;16398;16418;16398;16427;16387;16428;16414;16422;16386;16442;16395;16422;16367;16442;16346;16434;16362;16450;16365;16459;16370;16460;16382;16454;16367;16459;16384;16455;16355;16470;16369;16479;16355;16452;16327;16442;16374;16462;16341;16495;16342;16484;16376;16462;16323;16469;16342;16455;16350;16474;16362;16467;16334;16489;16332;16479;16343;16479;16385;16474;16359;16445;16353;16462;16359;16459;16380;16446;16371;16448;16385;16450;16379;16428;16395;16411;16391;16410;16405;16395;16418;16387;16434;16379;16442;16353;16450;16330;16447;16346;16459;16359;16462;16351;16464;16359;16478;16340;16476;16338;16475;16348;16496;16347;16491;16354;16473;16363;16459;16361;16448;16371;16419;16423;16410;16414;16390;16432;16388;16438;16382;16441;16366;16459;16343;16474;16356;16470;16338;16454;16342;16470;16355;16490;16330;16463;16347;16459;16371;16447;16378;16423;16405;16419;16403;16389;16421;16374;16430;16355;16457;16363;16482;16359;16479;16303;16466;16346;16462;16331;16458;16373;16463;16379;16455;16384;16427;16430;16414;16412;16397;16423;16355;16474;16379;16442;16339;16478;16342;16470;16335;16478;16342;16470;16406;16447;16377;16415;16383;16421;16430;16390;16462;16395;16473;16366;16486;16346;16470;16354;16487;16334;16481;16371;16483;16374;16473;16403;16419;16413;16402;16455;16379;16460;16398;16518;16354;16498;16360;16486;16367;16477;16373;16447;16414;16463;16454;16402;16447;16397;16468;16375;16475;16358;16493;16350;16503;16359;16497;16402;16454;16385;16416;16439;16386;16460;16383;16487;16366;16497;16356;16498;16334;16471;16373;16467;16394;16429;16429;16431;16458;16376;16438;16367;16490;16332;16492;16350;16498;16375;16488;16399;16439;16409;16419;16451;16374;16437;16369;16491;16342;16494;16348;16494;16355;16457;16372;16462;16390;16418;16431;16387;16446;16379;16485;16355;16498;16350;16485;16339;16471;16339;16456;16402;16443;16431;16401;16458;16375;16474;16337;16498;16335;16488;16357;16462;16407;16449;16417;16427;16451;16346;16497;16390;16502;16333;16499;16359;16474;16369;16441;16411;16439;16444;16397;16470;16386;16483;16346;16498;16355;16483;16381;16470;16419;16424;16460;16390;16459;16365;16481;16355;16494;16372;16486;16427;16450;16423;16435;16443;16414;16512;16376;16495;16347;16506;16380;16510;16411;16457;16423;16414;16454;16398;16489;16371;16490;16364;16491;16390;16474;16425;16425;16463;16371;16472;16350;16510;16354;16490;16365;16474;16414;16443;16458;16391;16471;16350;16493;16339;16503;16357;16466;16411;16430;16453;16416;16459;16327;16469;16334;16479;16366;16479;16410;16430;16434;16385;16455;16359;16495;16348;16489;16355;16470;16419;16436;16435;16399;16481;16358;16519;16351;16486;16371;16466;16406;16409;16438;16382;16503;16355;16509;16334;16506;16385;16413;16403;16391;16467;16370;16507;16351;16491;16373;16455;16403;16425;16438;16367;16475;16374;16523;16374;16487;16400;16431;16434;16395;16464;16349;16506;16338;16509;16366;16495;16435;16426;16441;16375;16471;16348;16508;16363;16475;16389;16442;16451;16398;16499;16366;16503;16374;16473;16402;16439;16446;16401;16485;16378;16495;16357;16524;16382;16427;16430;16387;16479;16354;16503;16356;16486;16394;16450;16430;16407;16479;16373;16508;16331;16479;16395;16450;16442;16402;16501;16376;16514;16351;16476;16393;16438;16446;16387;16484;16358;16539;16383;16440;16399;16423;16456;16387;16519;16375;16522;16358;16502;16427;16430;16467;16375;16514;16371;16522;16411;16491;16441;16430;16498;16366;16497;16365;16527;16410;16469;16474;16395;16487;16355;16523;16382;16503;16423;16462;16471;16395;16512;16347;16530;16362;16500;16412;16427;16462;16416;16512;16378;16515;16380;16511;16423;16458;16478;16395;16518;16375;16536;16377;16514;16446;16438;16486;16407;16511;16378;16515;16383;16507;16423;16456;16450;16434;16518;16365;16534;16367;16508;16407;16430;16466;16411;16518;16402;16518;16370;16524;16406;16482;16454;16412;16475;16367;16523;16368;16535;16390;16518;16428;16443;16471;16388;16522;16379;16514;16366;16500;16407;16471;16458;16421;16510;16375;16493;16388;16519;16410;16513;16443;16451;16482;16398;16518;16367;16550;16395;16522;16438;16503;16465;16423;16506;16382;16509;16372;16506;16402;16508;16442;16486;16459;16419;16493;16418;16506;16384;16548;16391;16490;16448;16474;16490;16418;16512;16379;16518;16391;16537;16388;16498;16463;16474;16474;16403;16491;16387;16519;16350;16535;16407;16495;16443;16478;16488;16450;16510;16383;16520;16380;16526;16391;16513;16402;16462;16466;16457;16485;16419;16515;16382;16540;16395;16527;16410;16464;16446;16426;16484;16397;16507;16390;16505;16359;16562;16394;16505;16417;16462;16442;16428;16487;16407;16515;16385;16542;16402;16546;16389;16526;16430;16463;16460;16411;16511;16407;16521;16383;16530;16395;16533;16406;16514;16422;16465;16483;16451;16503;16406;16516;16386;16502;16368;16526;16402;16494;16415;16489;16471;16426;16508;16413;16499;16398;16511;16379;16531;16383;16533;16435;16495;16459;16428;16450;16419;16510;16411;16539;16395;16538;16402;16537;16390;16507;16420;16488;16454;16474;16471;16434;16514;16403;16519;16394;16535;16386;16518;16406;16534;16423;16485;16434;16450;16479;16414;16509;16406;16511;16363;16513;16379;16535;16396;16533;16431;16451;16436;16462;16467;16403;16481;16383;16515;16378;16530;16407;16527;16387;16520;16417;16495;16455;16500;16459;16443;16495;16387;16522;16402;16507;16385;16539;16403;16542;16431;16496;16422;16462;16457;16454;16470;16435;16516;16431;16527;16395;16533;16378;16535;16402;16516;16414;16514;16454;16493;16481;16454;16482;16442;16500;16411;16511;16401;16546;16395;16571;16415;16533;16418;16523;16407;16512;16442;16486;16446;16459;16503;16423;16481;16422;16518;16447;16533;16407;16531;16399;16543;16398;16542;16447;16530;16448;16499;16471;16491;16474;16462;16471;16441;16503;16427;16522;16431;16555;16415;16550;16408;16525;16407;16551;16417;16544;16447;16514;16431;16479;16446;16479;16484;16466;16495;16466;16492;16414;16518;16411;16534;16411;16535;16414;16547;16427;16555;16427;16527;16430;16519;16443;16528;16457;16519;16475;16519;16459;16475;16498;16482;16524;";
			 ctx.writeAndFlush(responseMsg);		
		 }
		
	}
	
}

class DelimiterEncoder extends MessageToByteEncoder<String> {
	
	private static final String LINE_SEPARATOR = System.getProperty("line.separator");

	@Override
	protected void encode(ChannelHandlerContext ctx, String msg, ByteBuf out) throws Exception {
		
		ByteBufAllocator alloc = ctx.alloc();
		CompositeByteBuf compositeBuffer = alloc.compositeBuffer();
		byte[] content = msg.getBytes(StandardCharsets.UTF_8);
		compositeBuffer.addComponents(
				true, 
				alloc.buffer().writeBytes(content),
				alloc.buffer().writeBytes(LINE_SEPARATOR.getBytes(StandardCharsets.UTF_8)));
		ctx.writeAndFlush(compositeBuffer);
	}

}


